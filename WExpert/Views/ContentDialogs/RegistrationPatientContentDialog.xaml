<base:WEXBaseContentDialog
    x:Class="WExpert.Views.ContentDialogs.RegistrationPatientContentDialog"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:base="using:WExpert.Views.Base"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:viewModels="using:WExpert.ViewModels"
    xmlns:converter="using:WExpert.Binding.Converter"
    IsPrimaryButtonEnabled="{x:Bind ViewModel.EnableRegisterButton, Mode=OneWay}"
    Loaded="Dialog_Loaded">

    <base:WEXBaseContentDialog.Resources>
        <converter:WEXRegisterPatientConverter x:Key="wexRegisterPatientConverter"/>
        
        <!-- #region TextBlock Style -->
        <Style x:Key="RegistrationPatientLocalContentDialogTextStyle1" TargetType="TextBlock"
               BasedOn="{StaticResource TextBlockStyleBase}">
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="HorizontalAlignment" Value="Right"/>
            <Setter Property="Foreground" Value="{StaticResource ComponentsRed}"/>
            <Setter Property="TextTrimming" Value="CharacterEllipsis"/>
            <Setter Property="Margin" Value="10,0,10,0"/>
        </Style>

        <Style x:Key="RegistrationPatientLocalContentDialogTextStyle2" TargetType="TextBlock"
           BasedOn="{StaticResource TextBlockStyleBase}">
            <Setter Property="FontSize" Value="12" />
            <Setter Property="Height" Value="20"/>
            <Setter Property="TextTrimming" Value="CharacterEllipsis"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="Foreground" Value="{StaticResource TextPrimary}"/>
        </Style>

        <Style x:Key="RegistrationPatientLocalContentDialogTextStyle3" TargetType="TextBlock"
           BasedOn="{StaticResource TextBlockStyleBase}">
            <Setter Property="Foreground" Value="{StaticResource TextSecondary}"/>
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="LineHeight" Value="24"/>
        </Style>

        <Style x:Key="RegistrationPatientLocalContentDialogTextStyle4" TargetType="TextBlock"
           BasedOn="{StaticResource TextBlockStyleBase}">
            <Setter Property="Foreground" Value="{StaticResource ComponentsBlue}"/>
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="LineHeight" Value="24"/>
            <Setter Property="TextDecorations" Value="Underline"/>
        </Style>

        <Style x:Key="RegistrationPatientLocalContentDialogTextStyle5" TargetType="TextBlock"
           BasedOn="{StaticResource TextBlockStyleBase}">
            <Setter Property="Foreground" Value="{StaticResource SolidLtSolid}"/>
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="LineHeight" Value="24"/>
            <Setter Property="TextAlignment" Value="Center"/>
        </Style>

        <Style x:Key="RegistrationPatientLocalContentDialogTextStyle6" TargetType="TextBlock"
           BasedOn="{StaticResource TextBlockStyleBase}">
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="Margin" Value="0,0,0,0"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="Foreground" Value="{StaticResource TextTertiary}"/>
        </Style>
        <!-- #endregion TextBlock Style -->
        
        <!-- TextBox -->
        <Style x:Key="RegistrationPatientLocalContentDialogTextBoxStyle1" TargetType="TextBox"
               BasedOn="{StaticResource WEXLineTextBoxStyle1}">
            <Setter Property="Height" Value="38"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Padding" Value="10,10,10,0"/>
            <Setter Property="CornerRadius" Value="6"/>
            <Setter Property="MaxLength" Value="50" />
        </Style>
        
        <!-- Radion Button -->
        <Style x:Key="RegistrationPatientContentDialogRadioButtonStyle1" TargetType="RadioButton"
               BasedOn="{StaticResource WEXRadioButtonStyle1}">
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontFamily" Value="{StaticResource DefaultFont}"/>
            <Setter Property="Foreground" Value="{StaticResource TextPrimary}"/>
        </Style>
        
        <!-- Button Style -->
        <Style x:Key="RegistrationPatientContentDialogButtonStyle1" TargetType="Button"
           BasedOn="{StaticResource WEXSolidButtonStyle3}">
            <Setter Property="Foreground" Value="{StaticResource WBlue50}" />
            <Setter Property="Width" Value="30" />
            <Setter Property="Height" Value="30" />
            <Setter Property="Padding" Value="0" />
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="CornerRadius" Value="5" />
        </Style>

        <!-- ListView Style -->
        <Style x:Key="RegistrationPatientContentDialogListViewStyle1" TargetType="ListView">
            <Setter Property="FontFamily" Value="{StaticResource DefaultFont}"/>
            <Setter Property="FontWeight" Value="Normal" />
            <Setter Property="Height" Value="220"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="CornerRadius" Value="6"/>
            <Setter Property="Margin" Value="0,5,0,5"/>
            <Setter Property="Background" Value="Transparent"/>
        </Style>
    </base:WEXBaseContentDialog.Resources>
    
    <!--
    <ContentDialog.DataContext>
        <viewModels:RegistrationPatientContentViewModel x:Name="ViewModel"/>
    </ContentDialog.DataContext>
    -->

    <!-- #region Titlebar 영역 -->
    <base:WEXBaseContentDialog.TitleTemplate>
        <DataTemplate>
            <Grid MaxWidth="600" MinWidth="600" Height="70">

                <TextBlock x:Uid="CtlRegistrionPatient" 
                        Style="{StaticResource ContentDialogTitleTextBlockStyle1}"
                        VerticalAlignment="Center"/>

                <Button Style="{StaticResource DialogCloseButtonStyle1}" 
                    Click="OnClose"
                    HorizontalAlignment="Right">
                    <Image Style="{StaticResource DialogHeaderCloseButtonStyle1}"/>
                    <ToolTipService.ToolTip>
                        <ToolTip x:Uid="CtlCloseTooltip"/>
                    </ToolTipService.ToolTip>
                </Button>               
            </Grid>
        </DataTemplate>
    </base:WEXBaseContentDialog.TitleTemplate>
    <!-- #endregion -->
    
    <!-- #region Body 영역 -->
    <ScrollViewer>
        <Grid Margin="26,0,26,0" Width="540">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="25"/>
                <!-- <RowDefinition Height="Auto"/> --> <!-- TODO. Type 항목은 임시 삭제(추후 버전 업시 추가 예정) -->
                <RowDefinition Height="0"/>
                <RowDefinition Height="25"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="25"/>
                <!--<RowDefinition Height="*"/>-->
            </Grid.RowDefinitions>

            <!-- Name -->
            <Grid Grid.Row="0">
                <StackPanel Orientation="Vertical">
                    <TextBlock x:Uid="CtlName"
                                Style="{StaticResource ContentDialogLabelTextStyle1}"/>
                    <TextBox x:Uid="PatientName"
                                TabIndex="0"
                                Style="{StaticResource RegistrationPatientLocalContentDialogTextBoxStyle1}"
                                Text="{x:Bind ViewModel.Name, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                </StackPanel>
            </Grid>
            
            <!-- Type -->
            <Grid Grid.Row="2">
                <StackPanel Orientation="Vertical">
                    <TextBlock x:Uid="CtlType"
                               Style="{StaticResource ContentDialogLabelTextStyle1}"/>

                    <StackPanel Orientation="Horizontal">
                        <!-- RadioButton 간 margin 문제로 인해 RadioButtons 은 사용 하지않고 RadioButton 을 직접사용 -->
                        <!--<RadioButtons SelectedIndex="0" MaxColumns="3" Style="{StaticResource WEXRadioButtonsStyle1}">-->
                        <RadioButton x:Name="TypeAesthetic"
                                        x:Uid="CtlAesthetic"
                                        Style="{StaticResource RegistrationPatientContentDialogRadioButtonStyle1}"
                                        Checked="PatientType_Checked"
                                        IsChecked="{x:Bind ViewModel.Type, Mode=OneWay, Converter={StaticResource wexRegisterPatientConverter}, ConverterParameter='Type-Aesthetic'}"/>
                        <RadioButton x:Name="TypeReconstructive"
                                        x:Uid="CtlReconstructive"
                                        Margin="20,0,20,0"
                                        Style="{StaticResource RegistrationPatientContentDialogRadioButtonStyle1}"
                                        Checked="PatientType_Checked"
                                        IsChecked="{x:Bind ViewModel.Type, Mode=OneWay, Converter={StaticResource wexRegisterPatientConverter}, ConverterParameter='Type-Reconstructive'}"/>
                        <RadioButton x:Name="TypeBoth"
                                        x:Uid="CtlBoth"
                                        Style="{StaticResource RegistrationPatientContentDialogRadioButtonStyle1}"
                                        Checked="PatientType_Checked"
                                        IsChecked="{x:Bind ViewModel.Type, Mode=OneWay, Converter={StaticResource wexRegisterPatientConverter}, ConverterParameter='Type-Both'}"/>
                        <!--</RadioButtons>-->
                    </StackPanel>    
                </StackPanel>
            </Grid>

            <!-- File Path -->
            <Grid Grid.Row="4">
                <StackPanel Orientation="Vertical">
                    <Grid Margin="0,0,0,10">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <Grid Grid.Column="0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition/>
                                <ColumnDefinition Width="3"/>
                                <ColumnDefinition/>
                            </Grid.ColumnDefinitions>
                            <Grid Grid.Column="0">
                                <TextBlock x:Uid="CtlSourceFile"
                                           Style="{StaticResource RegistrationPatientLocalContentDialogTextStyle6}"/>
                            </Grid>

                            <Grid Grid.Column="2"
                                  Visibility="{x:Bind ViewModel.RegistrationFileCount, Mode=OneWay, Converter={StaticResource wexRegisterPatientConverter}, ConverterParameter='ShowFileListNButton'}">
                                <Grid Width="30" Height="30">
                                    <Image Width="15"
                                            Height="15"
                                            Source="ms-appx:///Assets/Images/Minus-Circle.png"/>
                                </Grid>                                    
                                <Button x:Name="AddFileButton"
                                        Style="{StaticResource RegistrationPatientContentDialogButtonStyle1}"
                                        Visibility="{x:Bind ViewModel.RegistrationFileCount, Mode=OneWay, Converter={StaticResource wexRegisterPatientConverter}, ConverterParameter='ShowAddFileButton'}"
                                        Command="{x:Bind ViewModel.FileSelectorCommand}">
                                    <Image Width="15"
                                            Height="15"
                                            Source="ms-appx:///Assets/Images/Plus-Circle.png"/>
                                    <ToolTipService.ToolTip>
                                        <ToolTip x:Uid="CtlAddFile"/>
                                    </ToolTipService.ToolTip>
                                </Button>                                
                            </Grid>                                
                        </Grid>

                        <Grid Grid.Column="1">
                            <TextBlock Style="{StaticResource RegistrationPatientLocalContentDialogTextStyle1}"
                                        Text="{x:Bind ViewModel.RegistrationErrorMessage, Mode=OneWay}"
                                        Visibility="{x:Bind ViewModel.RegistrationErrorMessage, Mode=OneWay, Converter={StaticResource wexRegisterPatientConverter}, ConverterParameter='ShowErrorMessage'}"/>
                        </Grid>
                        
                        <Grid Grid.Column="2">
                            <TextBlock  Style="{StaticResource ContentDialogLabelTextStyle2}">
                                <Run Foreground="{x:Bind ViewModel.RegistrationFileCount, Mode=OneWay, Converter={StaticResource wexRegisterPatientConverter}, ConverterParameter='RegistrationFileCountColor'}"
                                        Text="{x:Bind ViewModel.RegistrationFileCount, Mode=OneWay}"/>
                                <Run Foreground="{StaticResource SolidLtSolid}"
                                        Text="{x:Bind ViewModel.MaxRegistrationFileCount, Mode=OneWay}"/>
                            </TextBlock>
                        </Grid>
                    </Grid>

                    <Grid Height="230" 
                          Background="Transparent"
                          AllowDrop="True"
                          DragEnter="SourceFile_DragEnterAsync"
                          DragOver="SourceFile_DragOver"
                          Drop="SourceFile_Drop">

                        <Rectangle Stroke="{StaticResource SolidLtSolid}"
                                    StrokeThickness="1"
                                    StrokeDashArray="{x:Bind ViewModel.FileListOutline, Mode=OneWay}"
                                    RadiusX="8"
                                    RadiusY="8" />
                        
                        <!-- Listview hint text -->
                        <StackPanel Orientation="Vertical"
                                    VerticalAlignment="Center"
                                    Visibility="{x:Bind ViewModel.ShowNewRegListHint, Mode=OneWay}">
                            <Image Width="24"
                                    Height="24"
                                    Stretch="Uniform"
                                    Source="ms-appx:///Assets/Images/Upload.png"/>

                            <StackPanel Orientation="Horizontal"
                                        Margin="0,17,0,0"
                                        VerticalAlignment="Center"
                                        HorizontalAlignment="Center">
                                <TextBlock x:Uid="CtlDragDrop"
                                            Style="{StaticResource RegistrationPatientLocalContentDialogTextStyle3}"/>

                                <HyperlinkButton Margin="5,0,0,0"
                                                    Command="{x:Bind ViewModel.FileSelectorCommand}"
                                                    Padding="0">
                                    <TextBlock x:Uid="CtlChooseFiles"
                                                Style="{StaticResource RegistrationPatientLocalContentDialogTextStyle4}"/>
                                </HyperlinkButton>

                            </StackPanel>
                            <TextBlock x:Uid="CtlSupportedFormat"
                                        Style="{StaticResource RegistrationPatientLocalContentDialogTextStyle5}"/>
                        </StackPanel>

                        <ListView Style="{StaticResource RegistrationPatientContentDialogListViewStyle1}"
                                  ItemContainerStyle="{StaticResource WEXBaseListViewItemStyle1}"
                                  Visibility="{x:Bind ViewModel.RegistrationFileCount, Mode=OneWay, Converter={StaticResource wexRegisterPatientConverter}, ConverterParameter='ShowFileListNButton'}"
                                  ContainerContentChanging="SourceFile_ContainerContentChanging"
                                  ItemsSource="{x:Bind ViewModel.NewRegistrationFiles, Mode=OneWay}">
                            <ListView.ItemTemplate>
                                <DataTemplate>
                                    <Grid Background="Transparent">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width = "50"/>
                                            <ColumnDefinition Width = "14"/>
                                            <ColumnDefinition Width = "*"/>
                                            <ColumnDefinition Width = "5"/>
                                            <ColumnDefinition Width = "Auto"/>
                                        </Grid.ColumnDefinitions>

                                        <Grid Grid.Column="0" Background="{StaticResource ComponentsBlack}" CornerRadius="3">
                                            <!-- Thumbnail -->
                                            <Image Source="{Binding FilePath, Mode=OneWay}" Width="50" Height="30"
                                                   ImageFailed="Thumbnail_ImageFailed"/>
                                        </Grid>
                                        <Grid Grid.Column="2">
                                            <!-- File Name -->
                                            <TextBlock Style="{StaticResource RegistrationPatientLocalContentDialogTextStyle2}"
                                                       Text="{Binding DestFileName, Mode=OneWay}"/>
                                        </Grid>
                                        <Grid Grid.Column="4">
                                            <Button Style="{StaticResource CommonDialogButtonStyle1}"
                                                                    Click="DeleteSourceItemClick">
                                                <Image Width="15" Height="15" Source="ms-appx:///Assets/Images/Trash.png"/>

                                                <ToolTipService.ToolTip>
                                                    <ToolTip x:Uid="CtlDeleteTooltip"/>
                                                </ToolTipService.ToolTip>
                                                
                                            </Button>
                                        </Grid>
                                    </Grid>
                                </DataTemplate>
                            </ListView.ItemTemplate>
                        </ListView>                        
                    </Grid>
                </StackPanel>
            </Grid>

            <!-- Progress Ring -->
            <Grid Grid.RowSpan="6">
                <ProgressRing IsActive="{x:Bind ViewModel.RegisteringProgressRing, Mode=OneWay}"
                                Style="{StaticResource WEXProgressRingStyle1}"/>
            </Grid>
        </Grid>
    </ScrollViewer>
    <!-- #endregion -->
    
</base:WEXBaseContentDialog>
