<base:WEXBaseContentDialog
    x:Class="wai.Views.ContentDialogs.ForgetPasswordDialog"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:base="using:WExpert.Views.Base"
    xmlns:viewModels="using:WExpert.ViewModels"
    xmlns:converter="using:WExpert.Binding.Converter"
    Loaded="Dialog_Loaded">

    <base:WEXBaseContentDialog.Resources>
        <!-- RichTextBlock -->        
        <Style x:Key="ForgetPwdLocalRichTextBlockStyle1" TargetType="RichTextBlock"
               BasedOn="{StaticResource RichTextBlockStyleBase}">
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="LineHeight" Value="24"/>
            <Setter Property="Foreground" Value="{StaticResource TextTertiary}"/>
            <Setter Property="TextWrapping" Value="Wrap" />
        </Style>

        <!-- TextBlock -->
        <Style x:Key="ForgetPwdLocalBlockStyle1" TargetType="TextBlock"
               BasedOn="{StaticResource TextBlockStyleBase}">
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="Margin" Value="0,0,0,10"/>
            <Setter Property="Foreground" Value="{StaticResource TextTertiary}"/>
        </Style>
        
        <!-- TextBox -->
        <Style x:Key="ForgetPwdLocalTextBoxStyle1" TargetType="TextBox"
               BasedOn="{StaticResource WEXLineTextBoxStyle1}">
            <Setter Property="Height" Value="40"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Padding" Value="10 "/>
            <Setter Property="CornerRadius" Value="6"/>
            <Setter Property="MaxLength" Value="20"/>
        </Style>

        <Style x:Key="ForgetPwdLocalTextBoxStyle2" TargetType="TextBox"
               BasedOn="{StaticResource WEXLineTextBoxStyle1}">
            <Setter Property="Height" Value="40"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Padding" Value="10 "/>
            <Setter Property="CornerRadius" Value="6"/>
            <Setter Property="MaxLength" Value="6"/>
        </Style>

        <Style x:Key="ForgetPwdLocalTextBoxStyle3" TargetType="TextBox"
               BasedOn="{StaticResource ForgetPwdLocalTextBoxStyle1}">
            <Setter Property="MaxLength" Value="50"/>
        </Style>

        <!-- Button -->
        <Style x:Key="ForgetPwdLocalButtonStyle1" TargetType="Button"
               BasedOn="{StaticResource WEXSolidButtonStyle1}">
            <Setter Property="Width" Value="130" />
            <Setter Property="Height" Value="42" />
            <Setter Property="Margin" Value="10,0,0,0" />
            <Setter Property="CornerRadius" Value="6" />
            <Setter Property="FontSize" Value="14" />
        </Style>

        <Style x:Key="ForgetPwdLocalButtonStyle2" TargetType="Button"
               BasedOn="{StaticResource WEXSolidButtonStyle1}">
            <Setter Property="Height" Value="44" />
            <Setter Property="Margin" Value="0,14,0,14" />
            <Setter Property="CornerRadius" Value="6" />
            <Setter Property="FontSize" Value="16" />
            <Setter Property="VerticalAlignment" Value="Center" />
            <Setter Property="HorizontalAlignment" Value="Stretch" />
        </Style>
        
        <!-- Password Box -->
        <Style x:Key="ForgetPwdLocalPasswordBoxStyle1" TargetType="PasswordBox"
               BasedOn="{StaticResource WEXLinePasswordBoxStyle1}">
            <Setter Property="Height" Value="44" />
            <Setter Property="FontSize" Value="15" />
            <Setter Property="Padding" Value="10,10,10,10" />
            <Setter Property="CornerRadius" Value="6" />
            <Setter Property="MaxLength" Value="16" />
        </Style>
    </base:WEXBaseContentDialog.Resources>

    <!--
    <ContentDialog.DataContext>
        <viewModels:ForgetPasswordContentViewModel x:Name="ViewModel"/>
    </ContentDialog.DataContext>
    -->

    <!-- #region Titlebar 영역 -->
    <base:WEXBaseContentDialog.TitleTemplate>
        <DataTemplate>
            <Grid MinWidth="550"
                  MaxWidth="550"
                  Height="32"
                  Margin="0,20,0,0">
                <TextBlock Text="{Binding DialogTitle, Mode=OneWay}"
                           Style="{StaticResource ContentDialogTitleTextBlockStyle1}"/>

                <!-- TODO .. binding 을 통해 close 시키기 -->
                <Button Style="{StaticResource DialogCloseButtonStyle1}" Click="OnClose">
                    <Image Style="{StaticResource DialogHeaderCloseButtonStyle1}"/>
                    <ToolTipService.ToolTip>
                        <ToolTip x:Uid="CtlCloseTooltip" />
                    </ToolTipService.ToolTip>
                </Button>
            </Grid>
        </DataTemplate>
    </base:WEXBaseContentDialog.TitleTemplate>
    <!-- endregion -->

    <!-- Body 영역 -->
    <ScrollViewer>
        <Grid Width="500" MinHeight="400" MaxHeight="460">
        
            <!-- 오류 메시지 출력을 위한 TeachingTip -->
            <TeachingTip x:Name="ForgetPasswordErrorTeachingTip"
                         PlacementMargin="10"
                         IsOpen="{x:Bind ViewModel.IsOpenErrorTeachingTip, Mode=OneWay}"
                         Style="{StaticResource TeachingTipErrorStyle1}">

                <TeachingTip.Content>
                    <Grid HorizontalAlignment="Left">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <Grid Grid.Column="0"
                                  VerticalAlignment="Top"
                                  Margin="0,0,12,0">
                            <Image Source="ms-appx:///Assets/Images/TitleIconWarnWhite.png"   
                                       Width="24"
                                       Height="24"/>
                        </Grid>
                        <Grid Grid.Column="1">
                            <TextBlock x:Name="ErrorMessage"
                                       TextWrapping="Wrap" 
                                       Style="{StaticResource ContentDialogLabelTextStyle5}"
                                       Margin="0,5,30,0" 
                                       Text=""/>
                        </Grid>
                    </Grid>
                </TeachingTip.Content>
            </TeachingTip>

            <!-- E-mail로 코드 전송 및 전송 받은 코드 Certification  -->
            <Grid x:Name="grdCertification" Height="460"
                  Visibility="{x:Bind ViewModel.ShowInputEmail, Mode=OneWay}">
                <Grid.RowDefinitions>
                    <RowDefinition Height="20"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="40"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="20"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <!-- Description  -->
                <Grid Grid.Row="1">
                    <TextBlock x:Uid="CtlForgetPasswordDesciption"
                               Style="{StaticResource ForgetPwdLocalBlockStyle1}"/>
                </Grid>
                      
                <!-- Email -->
                <Grid Grid.Row="3">
                    <StackPanel Orientation="Vertical">
                        <!-- ID Label -->
                        <TextBlock x:Uid="CtlId"
                                   Style="{StaticResource ForgetPwdLocalBlockStyle1}"/>

                        <!-- ID TextBox -->
                        <TextBox x:Name="IdTextBox"
                                x:Uid="CtlIDHint"
                                IsEnabled="{x:Bind ViewModel.EnableIdTextBox, Mode=OneWay}"
                                Style="{StaticResource ForgetPwdLocalTextBoxStyle1}"
                                Text="{x:Bind ViewModel.Id, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                KeyDown="IdTextBox_KeyDown"/>
                    
                        <Rectangle Height="20"/>

                        <!-- Email Label -->
                        <TextBlock x:Uid="CtlEmail"
                                   Style="{StaticResource ForgetPwdLocalBlockStyle1}"/>
                    
                        <!-- Email TextBox -->
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="144"/>
                            </Grid.ColumnDefinitions>

                            <Grid Grid.Column="0">
                                <TextBox x:Name="EmailTextBox"
                                         Grid.Column="0"
                                         x:Uid="CtlEmailHint"
                                         IsEnabled="{x:Bind ViewModel.EnableEmailTextBox, Mode=OneWay}"
                                         Style="{StaticResource ForgetPwdLocalTextBoxStyle3}"
                                         Text="{x:Bind ViewModel.Email, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                         KeyDown="EmailTextBox_KeyDown"/>
                            </Grid>

                            <Grid Grid.Column="1">
                                <Button x:Name="RequestOTPButton"
                                        Content="{x:Bind ViewModel.RequestButtonText , Mode=OneWay}"
                                        Style="{StaticResource ForgetPwdLocalButtonStyle1}"
                                        IsEnabled="{x:Bind ViewModel.EnableRequestCode, Mode=OneWay}"
                                        Command="{x:Bind ViewModel.RequestOTPCodeCommand}"/>

                                <ProgressRing IsActive="{x:Bind ViewModel.RequestCodeProgress, Mode=OneWay}"
                                              Style="{StaticResource WEXProgressRingStyle1}"/>
                            </Grid>

                        </Grid>
                    </StackPanel>
                </Grid>

                <!-- OTP 코드 입력 모드 -->
                <Grid Grid.Row="5" Visibility="{x:Bind ViewModel.ShowInputOTP, Mode=OneWay}">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="20"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="15"/>
                    </Grid.RowDefinitions>
                
                    <!-- Code -->
                    <Grid Grid.Row="0">
                        <StackPanel Orientation="Vertical">
                            <TextBlock x:Uid="CtlCode"
                                       Style="{StaticResource ForgetPwdLocalBlockStyle1}"/>
                            <TextBox x:Name="OTPCodeTextBox"
                                     x:Uid="CtlCodeHint"
                                     Style="{StaticResource ForgetPwdLocalTextBoxStyle2}"
                                     Text="{x:Bind ViewModel.OtpCode, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                     BeforeTextChanging="CodeTextBox_BeforeTextChanging" 
                                     KeyDown="CodeTextBox_KeyDown"/>
                        </StackPanel>
                    </Grid>

                    <!-- Certification Button -->
                    <Grid Grid.Row="3">
                        <Button x:Name="RequestCertificationButton" 
                                x:Uid="CtlVertification"
                                IsEnabled="{x:Bind ViewModel.EnableRequestCertification, Mode=OneWay}"
                                Style="{StaticResource ForgetPwdLocalButtonStyle2}"
                                Command="{x:Bind ViewModel.RequestOTPVerificationCommand}"/>

                        <ProgressRing IsActive="{x:Bind ViewModel.CertificationCodeProgress, Mode=OneWay}"
                                      Style="{StaticResource WEXProgressRingStyle1}"/>
                    </Grid>
                </Grid>
            </Grid>
        
            <!-- 비밀 번호 변경 화면 -->
            <Grid x:Name="grdChangePassword" Height="400"
                  Visibility="{x:Bind ViewModel.ShowInputPwd, Mode=OneWay}">
                <Grid.RowDefinitions>
                    <RowDefinition Height="20"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="40"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="20"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="30"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="15"/>
                </Grid.RowDefinitions>

                <!-- Description  -->
                <Grid Grid.Row="1">
                    <RichTextBlock Style="{StaticResource ForgetPwdLocalRichTextBlockStyle1}">
                        <Paragraph>
                            <Run x:Uid="CtlChangePasswordDesciption"/>
                        </Paragraph>
                    </RichTextBlock>
                </Grid>

                <!-- New password -->
                <Grid Grid.Row="3">
                    <StackPanel Orientation="Vertical">
                        <TextBlock x:Uid="CtlNewPassword"
                                   Style="{StaticResource ForgetPwdLocalBlockStyle1}"/>

                        <PasswordBox x:Name="newPasswordBox"
                                     x:Uid="CtlNewPasswordHint"                            
                                     Style="{StaticResource ForgetPwdLocalPasswordBoxStyle1}"
                                     GotFocus="PasswordBox_GotFocus"
                                     LostFocus="PasswordBox_LostFocus"
                                     PasswordChanged="PasswordBox_PasswordChanged"/>
                    </StackPanel>
                </Grid>

                <!-- Confirm password -->
                <Grid Grid.Row="5">
                    <StackPanel Orientation="Vertical">
                        <TextBlock x:Uid="CtlConfirmPassword"
                                   Style="{StaticResource ForgetPwdLocalBlockStyle1}"/>

                        <PasswordBox x:Name="confirmPasswordBox"
                                     x:Uid="CtlConfirmNewPasswordHint"                            
                                     Style="{StaticResource ForgetPwdLocalPasswordBoxStyle1}"
                                     GotFocus="PasswordBox_GotFocus"
                                     LostFocus="PasswordBox_LostFocus"
                                     PasswordChanged="PasswordBox_PasswordChanged"/>
                    </StackPanel>
                </Grid>

                <!-- Change Password Button -->
                <Grid Grid.Row="7">
                    <Button x:Name="ChangePasswordButton"
                            x:Uid="CtlChangePasswordBtn"
                            IsEnabled="{x:Bind ViewModel.EnableRequestChangePassword, Mode=OneWay}"
                            Style="{StaticResource ForgetPwdLocalButtonStyle2}"
                            Click="ChangePasswordBtn_Click"/>

                    <ProgressRing IsActive="{x:Bind ViewModel.RequestChangePasswordProgress, Mode=OneWay}"
                                  Style="{StaticResource WEXProgressRingStyle1}"/>
                </Grid>
            </Grid>
        </Grid>
    </ScrollViewer>
</base:WEXBaseContentDialog>