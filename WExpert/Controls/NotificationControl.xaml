<UserControl
    x:Class="WExpert.Controls.NotificationControl"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    VerticalAlignment="Bottom"
    HorizontalAlignment="Right">

    <UserControl.Resources>
        <Style x:Key="NotificationLocalInfoBarStyle1" TargetType="InfoBar">
            <Setter Property="Width" Value="300"/>
            <Setter Property="HorizontalAlignment" Value="Right"/>
            <Setter Property="VerticalAlignment" Value="Bottom"/>
            <Setter Property="Background" Value="{StaticResource BgBase}"/>
            <Setter Property="BorderBrush" Value="{StaticResource SolidDkSolid}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Margin" Value="20"/>
            <Setter Property="CornerRadius" Value="6"/>
            <Setter Property="Severity" Value="Informational"/>
            <Setter Property="IsIconVisible" Value="False"/>
            <Setter Property="IsClosable" Value="True"/>
            <Setter Property="Opacity" Value="0.95"/>
        </Style>

        <Style x:Key="NotificationLocalInfoBarStyle2" TargetType="TextBlock"
               BasedOn="{StaticResource TextBlockStyleBase}">
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="FontWeight" Value="Medium"/>
            <Setter Property="LineHeight" Value="24"/>
            <Setter Property="Foreground" Value="{StaticResource TextPrimary}"/>
        </Style>

        <Style x:Key="NotificationLocalInfoBarStyle3" TargetType="TextBlock"
               BasedOn="{StaticResource TextBlockStyleBase}">
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="MaxLines" Value="3"/>
            <Setter Property="LineHeight" Value="21"/>
            <Setter Property="TextWrapping" Value="Wrap"/>
            <Setter Property="Foreground" Value="{StaticResource TextPrimary}"/>
        </Style>
    </UserControl.Resources>
    
    <ItemsControl x:Name="NotificationsItemsControl"
                  ItemsSource="{x:Bind NotificationItems}"
                  Margin="0,0,20,20"
                  HorizontalAlignment="Right"
                  VerticalAlignment="Bottom">
        <ItemsControl.ItemsPanel>
            <ItemsPanelTemplate>
                <StackPanel Orientation="Vertical" />
            </ItemsPanelTemplate>
        </ItemsControl.ItemsPanel>
        <ItemsControl.ItemTemplate>
            <DataTemplate>
                <!--
                <InfoBar Style="{StaticResource NotificationLocalInfoBarStyle1}"
                         IsOpen="True" 
                         Message="{Binding Message}"
                         Severity="{Binding Severity}"
                         IsClosable="True"
                         CloseButtonClick="InfoBar_CloseButtonClick"/>
                -->                
                <InfoBar x:Name="NotificationPopup"
                         Style="{StaticResource NotificationLocalInfoBarStyle1}"
                         IsOpen="True"
                         Loaded="NotificationPopup_Loaded"
                         CloseButtonClick="NotificationPopup_CloseButtonClick">

                    <InfoBar.RenderTransform>
                        <TranslateTransform x:Name="PopupTranslateTransform" Y="100" />
                    </InfoBar.RenderTransform>

                    <InfoBar.Content>
                        <StackPanel Margin="8,20,0,20">
                            <TextBlock Text="{Binding Title}"
                                       Style="{StaticResource NotificationLocalInfoBarStyle2}" />
                            <Rectangle Height="10"/>
                            <TextBlock Text="{Binding Message}"
                                       Style="{StaticResource NotificationLocalInfoBarStyle3}" />
                        </StackPanel>
                    </InfoBar.Content>
                </InfoBar>
            </DataTemplate>
        </ItemsControl.ItemTemplate>
    </ItemsControl>
</UserControl>